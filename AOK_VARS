#!/bin/sh
# This is sourced. Fake bang-path to help editors and linters
#
# ShellCheck conditions at the top of the file are globals
# shellcheck disable=SC2034
#
#  Part of https://github.com/emkey1/AOK-Filesystem-Tools
#
#  License: MIT
#
#  Environment variables defining how this AOK-FS should be setup
#

#
#  Variables used during build.
#  Recomended is to copy this file to .AOK_VARS and make changes there.
#  This file will be ignored by git, and overrides this file. It also
#  minimizes risk of temp changes to become unintentionally permanent.
#  Only when you think a change should be saved into git, put it here!
#

#
#  Label for AOK builds, is also displayed by motd to indicate what
#  AOK FS release is being used
#
AOK_VERSION="Beta-003"

#
#  If defined this will be created as a no-password sudo capable user
#
USER_NAME="ish"

#
# Shell for user USER_NAME (if defined)
#
USER_SHELL="/bin/bash"

#
#  Alternatives are: enable disable once
#
INITIAL_LOGIN_MODE="enable"

#
#  Should normally not be set! If you want to hard-code timezone,
#  The FS will be setup without giving the option to select time-zone.
#  During testing its a convenient thing to set, not having to select a TZ
#  for every install.
#
# AOK_TIMEZONE="Europe/Berlin"

#
#  Use this if you have your own restore procedure.
#  If defined, this will be run after deploy has completed, at a time
#  when it should be running inside a full AOK FS
#  If this is a script, it must be available with this PATH on the new
#  FS, that means it most likely needs to be in the iCloud mount.
#  This one is also better to define in .AOK_VARS
#
# FIRST_BOOT_ADDITIONAL_TASKS="/iCloud/spd/bin/deploy-ish"

#
#  Should normally not be changed! Enabling his will create a limited env
#  missing features and functionality!
#
#  Purpose is to speed up the deploy cycle when testing and improving
#  the build processess on slow devices, by cutting down on deploy heavy
#  usability features.
#
#  Valid settings
#  --------------
#  0 - Disabled, full deploy will happen
#  1 - all quick deploy options are active, CORE_APKS will not be installed
#  2 - CORE_APKS will be installed, all other QUICK_DEPLOY conditions will
#      be followed. Handle this in your .AOK_VARS something like this:
#
#      if [ "$QUICK_DEPLOY" -gt 1 ]; then
#          #
#          #  Minimal list that will generate a usable system depends
#          #  on how you use it
#          #
#          CORE_APKS="openrc openssh-client bash"
#      else
#          #  Normal build - Skipping fortune, some like it I don't :)
#          CORE_APKS="$(echo "$CORE_APKS" | sed 's/fortune//')"
#      fi
#
QUICK_DEPLOY=0

########################################################################
#
#                   Alpine Specific
#
########################################################################

#
#  ALPINE_VERSION defines what Alpine release will be used
#
# ALPINE_VERSION=3.14.10 # End of Alpine support 2023-05-01
# ALPINE_VERSION=3.15.8 # End of Alpine support 2023-11-01
ALPINE_VERSION=3.16.5 # End of Alpine support 2024-05-23
# ALPINE_VERSION=3.17.3 # End of Alpine support 2024-11-22
# ALPINE_VERSION=edge # Current development tree

#
#  Always installed packages
#
CORE_APKS="busybox-extras coreutils findutils ncurses openrc openssh shadow sudo ssl_client tzdata util-linux bash zsh dcron dcron-openrc file gawk grep less newt rsync sed tar tmux mosh git ncurses-dev openssl-dev curl elinks ncftp vim nano fortune"

#
#  Additional packages. These don't work with stock iSH but work with
#  iSH-AOK and will probably work with the Linux Kernel iSH
#  Will only be installed if the kernel is identified as iSH-AOK.
#  If doing a prebuild, these will be installed regardless of
#  build platform, then on first boot at dest device, they
#  will be removed if at this time the env is not iSH-AOK
#
AOK_APKS="procps nload"

#
#  Additional APK groups managed with /usr/local/bin/aok_groups
#
#  Any variable ending with _APKS in this file, will be seen as a package
#  group by aok_groups and with that tool you can add/delete groups more
#  conveniently than having to open this file and then do cut/paste
#  repeatedly.
#
#  You can add/modify all the groups to your liking.
#  Again, consider using .AOK_VARS
#
VNC_APKS='x11vnc xvfb xterm xorg-server xf86-video-dummy i3wm i3status i3lock xdpyinfo xdpyinfo-doc i3wm-doc i3lock-doc i3status-doc ttf-dejavu'

DEVEL_APKS='build-base linux-headers cmake automake autoconf byacc py3-pip libffi-dev openssl-dev bzip2-dev zlib-dev xz-dev readline-dev sqlite-dev tk-dev libevent-dev ncurses-dev python3-dev'
NODEJS_APKS='nodejs nodejs-dev'
# BLOAT3_APKS='emacs neofetch'

DOCS_APKS='openssh-doc openrc-doc nload-doc htop-doc procps-doc tmux-doc mandoc shadow-doc mosh-doc fortune-doc tzdata-doc elinks-doc dcron-doc vim-doc ncftp-doc coreutils-doc findutils-doc tar-doc ncurses-doc less-doc sed-doc gawk-doc grep-doc util-linux-doc tzdata-doc x11vnc-doc xdpyinfo-doc i3wm-doc i3lock-doc i3status-doc strace-doc mandoc man-pages bash-doc strace-doc procps-doc rsync-doc htop-doc'

########################################################################
#
#                   Debian/Devuan Specific
#
########################################################################

#
#  If a Debian install is selected, this tarball will be used as base image
#
DEBIAN_SRC_IMAGE="https://www.dropbox.com/s/uzga9vf2rc2w2wg/Debian10-ish-base-v29.tgz"
DEVUAN_SRC_IMAGE="https://www.dropbox.com/s/6om4wppspe1pno7/Devuan_4-ish-base-v6.tgz"

#
#  Additional debs for Debian image
#
CORE_DEB_PKGS="openssh-client psmisc tzdata zsh file gawk less manpages whiptail rsync tmux mosh git build-essential python3-pip python3-minimal curl elinks ncftp openssl nano fortune-mod"
