#!/bin/sh
# This is sourced. Fake bang-path to help editors and linters
#
# ShellCheck conditions at the top of the file are globals
# shellcheck disable=SC2034
#
#  Part of https://github.com/jaclu/AOK-Filesystem-Tools
#
#  License: MIT
#
#  Environment variables defining how this AOK-FS should be setup
#

#
#  Variables used during build.
#  Recomended is to copy this file to .AOK_VARS and make changes there.
#  This file will be ignored by git, and overrides this file. It also
#  minimizes risk of temp changes to become unintentionally permanent.
#  Only when you think a change should be saved into git, put it here!
#

#
#  Label for AOK builds, is also displayed by motd to indicate what
#  AOK FS release is being used
#
AOK_VERSION="0.9.6-2"

#
#  If defined this will be created as a no-password sudo capable user
#
USER_NAME="ish"

#
# Shell for account USER_NAME (if defined)
#
USER_SHELL="/bin/bash"

#
#  Alternatives are: enable disable once
#  If USER_NAME is not set INITIAL_LOGIN_MODE will be forced to disable
#
INITIAL_LOGIN_MODE="enable"

#
#  Should normally not be set! If you want to hard-code timezone,
#  The FS will be setup without giving the option to select time-zone.
#  During testing its a convenient thing to set, not having to select a TZ
#  for every install.
#
# AOK_TIMEZONE="Europe/Berlin"

#
#  cron (dcron for Alpine), will allaways be installed
#  /etc/periodic placeholders will be created and a root crontab
#  running the periodics will be put in place.
#  The service will only be enabled if USE_CRON_SERVICE is set to "Y"
#  Otherwise theese settings have no impact on performance.
#  You can always decide later to activate the service.
#
# USE_CRON_SERVICE="Y"

#
#  Replaces /root and USER_NAME home dirs with pre-defined content, if defined
#  If USER_NAME is not set HOME_DIR_USER will be ignored.
#
# HOME_DIR_USER="/iCloud/ish_config/home_user.tgz"
# HOME_DIR_ROOT="/iCloud/ish_config/home_root.tgz"

#
#  If you run both iSH-AOK and regular iSH on the same device
#  this setting modifies the hostname for aok kernels to have -aok suffix
#  So my iPad JacPad would be calling itself JacPad-aok if you check
#  `hostname` on iSH-AOK and JacPad if you check on regular iSH
#
# AOK_HOSTNAME_SUFFIX="Y"

#
#  If you manually want to add something to the new FS, before deploy
#  begins. Remember that from the outside, the new FS is located at
#  $TMPDIR/AOK/FS
#  I use this when I want to simulate a mounted /iCloud env like what I
#  would have on my iPad, whilst testing the FS on a linux host chrooted
#  If the FS is being compressed its /iCloud is first cleared, so
#  anything you put in /iCloud will only be available for chrooted
#  sessions on the build host.
#  This one it is better to define in .AOK_VARS
#
# POPULATE_FS="rsync -ah /home/jaclu/iCloud $TMPDIR/AOK/FS"

#
#  Use this if you have your own restore procedure.
#  If defined, this will be run after deploy has completed, at a time
#  when it should be running inside a full AOK FS
#  If this is a script, it must be available with this PATH on the new
#  FS, that means it most likely needs to be in the iCloud mount.
#
# FIRST_BOOT_ADDITIONAL_TASKS="/iCloud/deploy/additional-tasks"

#
#  If LOG_FILE is defined build progress printed is also logged to this
#  file. This is mostly useful as a debugging tool, if during the deploy
#  something goes wrong and iSH crashes. This way you can at least get
#  an idea of how far things progressed before something broke.
#  This one it is better to define in .AOK_VARS
#
# LOG_FILE=/var/log/aokfs-build.log

########################################################################
#
#                   Alpine Specific
#
########################################################################

#
#  ALPINE_VERSION defines what Alpine release will be used
#
# ALPINE_VERSION=3.15.10 # End of Alpine support 2023-11-01
# ALPINE_VERSION=3.16.7 # End of Alpine support 2024-05-23
# ALPINE_VERSION=3.17.5 # End of Alpine support 2024-11-22
ALPINE_VERSION=3.18.3 # End of Alpine support 2025-05-09
#
#  For edge releases - Current development tree
#  format is the isodate featured in the minirootfs filename
#
# ALPINE_VERSION="20230901"  # 3.19_alpha20230901
# ALPINE_VERSION="20230329"  # 3.18_alpha20230329
# ALPINE_VERSION="20221110"  # 3.17_alpha20221110


#
#  Use this if you want to deploy your own /etc/hosts file etc
#  If the file(-s) are relevant both for Alpine and Debian, point it to the same
#  template file.
#  Check /opt/AOK/Docs/custom_files_template.sh for notation of this file
#
# ALPINE_CUSTOM_FILES_TEMPLATE="/iCloud/ish_config/alpine_files_template.sh"

#
#  Always installed packages
#
pkgs_tools="busybox-extras coreutils util-linux sudo shadow \
    shadow-login tzdata findutils sed tar file gawk grep less git \
    sqlite fzf py3-pip ncdu"
pkgs_shells="bash zsh"
pkgs_services="openrc dcron dcron-openrc"
pkgs_net_tools="ssl_client openssh rsync curl wget elinks mosh"
pkgs_editing="vim nano mg"
pkgs_text_ui="ncurses newt tmux"
pkgs_other="fortune"
CORE_APKS="$pkgs_tools $pkgs_shells $pkgs_services $pkgs_net_tools \
    $pkgs_editing $pkgs_text_ui $pkgs_other"

#
#  Additional packages. These don't work with stock iSH but work with
#  iSH-AOK and will probably work with the Linux Kernel iSH
#  Will only be installed if the kernel is identified as iSH-AOK.
#  If doing a prebuild, these will be installed regardless of
#  build platform, then on first boot at dest device, they
#  will be removed if at this time the env is not iSH-AOK
#
AOK_APKS="procps nload"

#
#  Additional APK groups managed with /usr/local/bin/aok_groups
#
#  Any variable ending with _APKS in this file, will be seen as a package
#  group by aok_groups and with that tool you can add/delete groups more
#  conveniently than having to open this file and then do cut/paste
#  repeatedly.
#
#  You can add/modify all the groups to your liking.
#  Again, consider using .AOK_VARS
#
VNC_APKS="x11vnc xvfb xterm xorg-server xf86-video-dummy i3wm i3status \
    i3lock xdpyinfo xdpyinfo-doc i3wm-doc i3lock-doc i3status-doc \
    ttf-dejavu"

DEVEL_APKS="build-base linux-headers cmake automake autoconf byacc \
    ncurses-dev openssl-dev readline-dev libffi-dev openssl-dev \
    bzip2-dev zlib-dev xz-dev sqlite-dev tk-dev libevent-dev \
    libtool ncurses-dev python3-dev"
NODEJS_APKS='nodejs nodejs-dev'
# BLOAT3_APKS='emacs neofetch'

DOCS_APKS="openssh-doc openrc-doc nload-doc procps-doc \
    tmux-doc mandoc shadow-doc mosh-doc fortune-doc tzdata-doc \
    elinks-doc dcron-doc vim-doc ncftp-doc coreutils-doc findutils-doc \
    tar-doc ncurses-doc less-doc sed-doc gawk-doc grep-doc \
    util-linux-doc tzdata-doc x11vnc-doc xdpyinfo-doc i3wm-doc \
    i3lock-doc i3status-doc strace-doc mandoc man-pages bash-doc \
    strace-doc procps-doc rsync-doc"

########################################################################
#
#                   Debian/Devuan Specific
#
########################################################################

#
#  If this type of install is selected, this tarball will be used as base image
#
DEBIAN_SRC_IMAGE="https://www.dropbox.com/scl/fi/uifhcafdb86241sgs26l3/Debian10-4-aok-2.tar.gz?rlkey=fh5ftnyky9t53tkz4x4wqiz40"
DEVUAN_SRC_IMAGE="https://www.dropbox.com/scl/fi/dwso0zjovoqb5bxdqev3c/Devuan_4-ish-base-v10.tgz?rlkey=h8h851hwsgds9s8s7j7n405b8"

#
#  All the AOK packages used on Alpine are pre-installed,
#  here one can add any additional packages to be installed during setup
#
DEB_PKGS=""

#
#  Since the Debian image comes pre installed with all the aok related
#  stuff, here you can list packages that should be deleted.
#  This happens during the pre-build when available,
#  it saves time compared to having to do it on the target device.
#
DEB_PKGS_SKIP=""

#
#  Use this if you want to deploy your own /etc/hosts file etc
#  If the file(-s) are relevant both for Alpine and Debian, point it to the same
#  template file.
#  Check /opt/AOK/Docs/custom_files_template.sh for notation of this file
#
# DEBIAN_CUSTOM_FILES_TEMPLATE="/iCloud/ish_config/debian_files_template.sh"
